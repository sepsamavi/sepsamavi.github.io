<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> SICNav-Diffusion: Safe and Interactive Crowd Navigation with Diffusion Trajectory Predictions | Sepehr Samavi </title> <meta name="author" content="Sepehr Samavi"> <meta name="description" content="Accepted to the IEEE Robotics and Automation Letters (RA-L)"> <meta name="keywords" content="sepehr, robotics, autonomous-vehicles, mpc, optimal-control, academic-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico?e0fe042f08e94ee40ea06bf2d65d59ee"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://sepsamavi.github.io/projects/sicnav_diffusion/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="//"> Sepehr Samavi </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/assets/pdf/SepehrSamavi_cv.pdf">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">SICNav-Diffusion: Safe and Interactive Crowd Navigation with Diffusion Trajectory Predictions</h1> <p class="post-description">Accepted to the IEEE Robotics and Automation Letters (RA-L)</p> </header> <article> <title>SICNav-Diffusion: Safe and Interactive Crowd Navigation with Diffusion Trajectory Predictions</title> <meta name="description" content="Accepted to the IEEE Robotics and Automation Letters (RA-L)"> <link rel="shortcut icon" href="https://sepsamavi.github.io/projects/sicnav_assets/jackal.ico"> <meta property="og:title" content="SICNav-Diffusion: Safe and Interactive Crowd Navigation with Diffusion Trajectory Predictions"> <meta property="og:description" content="Our MPC algorithm, SICNav, jointly optimizes robot trajectories (blue) and associated predicted human trajectories (green) for multiple humans. Our approach explicitly models interactions between agents while satisfying safety constraints."> <meta property="og:image" content="https://sepsamavi.github.io/projects/sicnav_assets/sicnav_social_overview.png"> <meta property="og:url" content="https://sepsamavi.github.io/projects/sicnav_diffusion/"> <meta property="og:type" content="website"> <meta property="og:site_name" content="Sepehr Samavi"> <meta property="og:locale" content="en_US"> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:title" content="SICNav-Diffusion: Safe and Interactive Crowd Navigation with Diffusion Trajectory Predictions"> <meta name="twitter:description" content="Our MPC algorithm, SICNav, jointly optimizes robot trajectories (blue) and associated predicted human trajectories (green) for multiple humans. Our approach explicitly models interactions between agents while satisfying safety constraints."> <meta name="twitter:image" content="https://sepsamavi.github.io/projects/sicnav_assets/sicnav_social_overview.png"> <meta name="twitter:url" content="https://sepsamavi.github.io/projects/sicnav_diffusion/"> <style>.yt{position:relative;display:block;width:99%;height:0;margin:auto;padding:0 0 56.25%;overflow:hidden}.yt iframe{position:absolute;top:0;bottom:0;left:0;width:100%;height:100%;border:0;padding-bottom:20px}.authors{display:flex;justify-content:center;text-align:center;flex-direction:row;flex-wrap:wrap;padding-top:0;padding-bottom:5px;gap:10px}.authors p{margin:0}.author-link{white-space:nowrap}.author-link::after{content:",";margin-right:5px}.author-link:last-child::after{content:""}.publication-links{display:flex;justify-content:center;padding-top:0;padding-bottom:30px;flex-wrap:wrap;gap:10px}.publication-links .link-block{margin-right:10px}.publication-links .button{padding:10px 10px;font-size:1.5em;display:flex;align-items:center;justify-content:center}.publication-links .button .icon{margin-right:10px}.publication-links .link-block:last-child{margin-right:0}@media(max-width:768px){.authors{flex-direction:row;flex-wrap:wrap;align-items:center;gap:5px}.publication-links{flex-direction:row;flex-wrap:wrap;align-items:center;gap:10px}.publication-links .button{width:auto;max-width:300px}}.row{display:flex;flex-wrap:wrap}.col-sm-4,.col-sm-8{display:flex;flex-direction:column;justify-content:flex-end}.caption{text-align:center;margin-top:1rem}</style> <div class="authors"> <a href="/" class="author-link" target="_blank">Sepehr Samavi</a> <a href="" class="author-link" target="_blank">Anthony Lem</a> <a href="https://ca.linkedin.com/in/fumiaki-sato-aa1347188" class="author-link" target="_blank" rel="external nofollow noopener">Fumiaki Sato</a> <a href="https://www.linkedin.com/in/sirui-chen-6492a0232" class="author-link" target="_blank" rel="external nofollow noopener">Sirui Chen</a> <a href="https://georgegu1997.github.io/" class="author-link" target="_blank" rel="external nofollow noopener">Qiao Gu</a> <a href="https://www.linkedin.com/in/keijiro-yano-892379a4" class="author-link" target="_blank" rel="external nofollow noopener">Keijiro Yano</a> <a href="https://www.schoellig.name" class="author-link" target="_blank" rel="external nofollow noopener">Angela P. Schoellig</a> <a href="http://www.cs.toronto.edu/~florian/" class="author-link" target="_blank" rel="external nofollow noopener">Florian Shkurti</a> </div> <div class="publication-links"> <span class="link-block"> <a href="https://arxiv.org/abs/2503.08858" class="external-link button is-normal is-rounded is-dark" rel="external nofollow noopener" target="_blank"> <span class="icon"> <i class="ai ai-arxiv"></i> </span> <span>arXiv</span> </a> </span> <span class="link-block"> <a href="https://github.com/sepsamavi/safe-interactive-crowdnav" class="external-link button is-normal is-rounded is-dark" rel="external nofollow noopener" target="_blank"> <span class="icon"> <i class="fab fa-github"></i> </span> <span>Code</span> </a> </span> <span class="link-block"> <a href="http://tiny.cc/sicnav_diffusion" class="external-link button is-normal is-rounded is-dark" rel="external nofollow noopener" target="_blank"> <span class="icon"> <i class="fab fa-youtube"></i> </span> <span>Videos</span> </a> </span> </div> <div class="row justify-content-sm-center align-items-end"> <div class="col-sm-8 mt-3 mt-md-0 d-flex flex-column align-items-center"> <div> <figure> <picture> <source class="responsive-img-srcset" srcset="/projects/sicnav_diffusion_assets/sicnav_diffusion_overview-480.webp 480w,/projects/sicnav_diffusion_assets/sicnav_diffusion_overview-800.webp 800w,/projects/sicnav_diffusion_assets/sicnav_diffusion_overview-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/projects/sicnav_diffusion_assets/sicnav_diffusion_overview.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="overview diagram" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="caption"> For interactive robotic crowd navigation, we propose a diffusion-based trajectory prediction model to forecast the future motion of humans as joint trajectory samples. We then feed the trajectory samples to the bilevel SICNav problem, which uses a particle-filter inspired approach to jointly refine the predictions (lower-level) and optimize robot actions that satisfy safety constraints (upper-level), resulting in a robot plan coupled with the refined predictions. When solving SICNav, the optimizer can explore trajectory prediction modes generated by the diffusion model and refine the predictions to be from the mode that best optimizes the robot objective, while guaranteeing safety (i.e. non-collision). We follow the SICNav solutions in receding horizon fashion. </div> </div> <div class="col-sm-4 mt-3 mt-md-0 d-flex flex-column align-items-center"> <div> <figure> <picture> <source class="responsive-img-srcset" srcset="/projects/sicnav_diffusion_assets/sicnav_diffusion_gif_splice-480.webp 480w,/projects/sicnav_diffusion_assets/sicnav_diffusion_gif_splice-800.webp 800w,/projects/sicnav_diffusion_assets/sicnav_diffusion_gif_splice-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/projects/sicnav_diffusion_assets/sicnav_diffusion_gif_splice.gif" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="sicnav-diffusion in action" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="caption"> To evaluate our approach we first validate the prediction performance of our proposed diffusion model on a dataset benchmark. To evaluate closed loop performance, we conduct simulation experiments and in-lab real-robot experiments. We also demonstrate the ability of our approach to work in the wild solely with on-board sensors and compute. </div> </div> </div> <h2 id="video">Video</h2> <div class="yt"> <iframe width="560" height="315" src="https://www.youtube.com/embed/GpclV9MiNTA?si=58Nj8cqWmDkq4mgd" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe> </div> <h2 id="abstract">Abstract</h2> <p>To navigate crowds without collisions, robots must interact with humans by forecasting their future motion and reacting accordingly. While learning-based prediction models have shown success in generating likely human trajectory predictions, integrating these stochastic models into a robot controller presents several challenges. The controller needs to account for interactive coupling between planned robot motion and human predictions while ensuring both predictions and robot actions are safe (i.e. collision-free). To address these challenges, we present a receding horizon crowd navigation method for single-robot multi-human environments. We first propose a diffusion model to generate joint trajectory predictions for all humans in the scene. We then incorporate these multi-modal predictions into a SICNav Bilevel MPC problem that simultaneously solves for a robot plan (upper-level) and acts as a safety filter to refine the predictions for non-collision (lower-level). Combining planning and prediction refinement into one bilevel problem ensures that the robot plan and human predictions are coupled. We validate the open-loop trajectory prediction performance of our diffusion model on the commonly used ETH/UCY benchmark and evaluate the closed-loop performance of our robot navigation method in simulation and extensive real-robot experiments demonstrating safe, efficient, and reactive robot motion.</p> <h2 id="bibtex">BibTex</h2> <div class="language-bibtex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">@article</span><span class="p">{</span><span class="nl">samavi2025sicnavdiffusion</span><span class="p">,</span>
      <span class="na">author</span><span class="p">=</span><span class="s">{Sepehr Samavi and Anthony Lem and Fumiaki Sato and Sirui Chen and Qiao Gu and Keijiro Yano and Angela P. Schoellig and Florian Shkurti}</span><span class="p">,</span>
      <span class="na">journal</span><span class="p">=</span><span class="s">{IEEE Robotics and Automation Letters (in press)}</span><span class="p">,</span>
      <span class="na">title</span><span class="p">=</span><span class="s">{SICNav-Diffusion: Safe and Interactive Crowd Navigation with Diffusion Trajectory Predictions}</span><span class="p">,</span>
      <span class="na">year</span><span class="p">=</span><span class="s">{2025}</span><span class="p">,</span>
      <span class="na">volume</span><span class="p">=</span><span class="s">{}</span><span class="p">,</span>
      <span class="na">number</span><span class="p">=</span><span class="s">{}</span><span class="p">,</span>
      <span class="na">pages</span><span class="p">=</span><span class="s">{}</span><span class="p">,</span>
      <span class="na">url</span><span class="p">=</span><span class="s">{https://arxiv.org/abs/2503.08858}</span>
<span class="p">}</span>
</code></pre></div></div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> Â© Copyright 2025 Sepehr Samavi. Powered by <a href="http://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. <a href="https://sepsamavi.github.io//">Impressum</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?da39b660470d1ba6e6b8bf5f37070b6e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>